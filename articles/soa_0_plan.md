---
title: "AWS SOA取得 計画"
emoji: "⏰"
type: "idea" # tech: 技術記事 / idea: アイデア
topics: ["AWS","SOA"]
published: true
---
# 目標
6/27(日)までにAW SOAを取得する。
※ 1~2週間前には事前に受験予約すること。

## 割引
- **模試**無料クーポンがあるから使うこと！
- **本試験**半額クーポンがあるから使うこと！

# 勉強時間
## 目安
100〜150時間前後

## 確保する勉強時間
- 受験日（仮） : 6/13(日)
- 受験日までの日数 : 72日(4/2~)
  - 平日 : 50日ぐらい ✕ 2時間 = 100時間
  - 休日 : 20日ぐらい ✕ 5時間 = 100時間

# SOA-C02
実技試験を伴う。
7~9月の間にリリースされる。
今回は、過去の受験者の知見を活用したいので、**C01を受ける。**

# 出題範囲(SOA-C01)
分野 1: モニタリングとレポート 22%
分野 2: 高可用性 8%
分野 3: デプロイとプロビジョニング 14%
分野 4: ストレージおよびデータの管理 12%
分野 5: セキュリティとコンプライアンス 18%
分野 6: ネットワーク 14%
分野 7: 自動化と最適化 12%

[公式試験ガイド](https://d1.awsstatic.com/ja_JP/training-and-certification/docs-sysops-associate/AWS-Certified-SysOps-Administrator-Associate_Exam-Guide.pdf)

# 教材
A. [AWS 認定 – 試験準備ワークショップ](https://www.aws.training/Details/Video?id=41299)
試験の攻略法を確認します
- 解答を選択する際の観点
- 問題の狙いを見極める方法
- アーキテクチャ設計の原則(超重要)

B.  [AWS サービス別資料(Black Belt)](https://aws.amazon.com/jp/aws-jp-introduction/aws-jp-webinar-service-cut/)

C.  [AWS 認定SysOpsアドミニストレーター アソシエイト模擬試験問題集（全4回分260問）](https://www.udemy.com/course/aws-sysops-53195-q/)
全体的にとても難しく、感覚としては公式の試験で10問に1問出るぐらいの難易度の問題をひたすら集めたような問題集になっています。なのでAWSサービスを概念や各機能の目的などがちゃんと理解できないないと解けない問題ばかりで学習コストが結構重いです。

補足 : [これだけでOK！AWS認定ソリューションアーキテクト – アソシエイト試験突破講座（購入済）](https://www.udemy.com/course/aws-associate/learn/quiz/4628740#overview)

D. [AWS ハンズオン](https://aws.amazon.com/jp/aws-jp-introduction/aws-jp-webinar-hands-on/)

E. [AWS チュートリアル](https://aws.amazon.com/jp/getting-started/hands-on/?awsf.getting-started-category=*all)

# 勉強方法
- [x] 1. 出題範囲を確認
- [x] 2. [試験問題サンプル](https://d1.awsstatic.com/ja_JP/training-and-certification/docs-sysops-associate/AWS-Certified-SysOps-Administrator-Associate_Sample-Questions.pdf)を解く
- [x] 3. 試験準備ワークショップ(A)で抑えるべきサービスと原則を確認
- [x] 4. サービス別資料(B)を一読
- [ ] 5. Udemy(C)の問題を解く (No.1~4)
- [ ] 6. (問題で分からない所がある場合)B.サービス別資料で復習+このノートに整理
- [ ] サービス郡でドキュメント分ける
- [ ] 7. 5と6が完了（1周目）
- [ ] 8. 5と6が完了（2周目）
- [ ] 8. 5と6が完了（3周目）
- [ ] 8. 5と6が完了（4周目）
- [ ] 8. 5と6が完了（5周目）

## Udemyの結果リスト
| 日付 | No. - n回目 | 正答率 | 備考 |
| --- | --- | --- | --- |
| 4/10 | 1-1 | 43% |  |
| 4/10 | 2-1 |  |  |
| 4/11 | 3-1 |  |  |
| 4/11 | 4-1 |  |  |


# 過去の受験者の感想
## <学習が特に必要な分野>
・セキュリティレポートの作成方法
・AWS Artifactとはなにか
・タグによるリソースの管理
・脆弱性チェックの深い理解
・IAMの組織アカウントに関する深い理解
・CLIのコマンド実行時のエラーへの対処方法(InsufficientErrorなど)

# BlackBelt
### 最重要
- service catalog
- WAF
- Organizations
- VPC
### 重要
- Powershell
- IAM2
- AWS support
- AWS Shield
  - Standard、Advanced、WAF、でそれぞれ何がブロック出来るのか、IDS、IPSとの使い分け
- AWS Artifact
  - 発行できるレポート
- EC2
  - トラブルシューティング(起動できない、insufficientエラー)、EC2Rescue
- RDS
  - メンテナンスが発生する対象、メンテナンス時の影響
- CLI
  - 各サービスを利用する為のCLIを色々と
- VPCフローログ
  - Logの見方


# 責任共有モデル
## AWS責任
- ユーザーがAWSクラウド内に展開したデータの所有権はユーザーが保持。（= AWSはユーザーの管理するデータにアクセスしない）
- データセンターとリージョンを相互接続する AWSグローバルネットワークを流れるすべてのデータは、安全性が保証された施設から外部に通信される前に物理レイヤーで自動的に暗号化されます。
- AWS側のインフラ環境は仮想化ソフトウェアでフィルタリングすることにより、ユーザーからはユーザーに割り当てられていない物理ホストまたはインスタンスにアクセスできない。
## ユーザ責任
- VPCネットワーク内の暗号化やセキュリティ対応


# 分野 1: モニタリングとレポート 22%

## Cloudwatch (重要)
  - 他サービスとの連携
  - CloudWatch events、alert機能の理解、データの流れの理解、メトリクス(カスタムメトリクス含む)　の仕組みと導入方法
  - CloudWatch EventsによりSNS通知をトリガー(実行)できます。
  - データポイント：デフォルトは、5分間隔。詳細モニタリングを有効にした場合、1分間隔。
  - 標準メトリクス
### カスタムメトリクス
**OSレベル**の問題チェックなど、標準メトリクスでは収集できないメトリクス。
CloudWatchエージェントを使用してメトリクス取得を設定することが必要。
AWS CLIからメトリクス(=監視対象)のモニタリング設定のスクリプトを記述して、そのメトリクスをCloudWatchにプッシュしてモニタリングを開始できる。
### CloudWatch エージェント
インストールすると、EC2インスタンスなどのシステム内部メトリクスとログファイルの両方を収集できる。
### Cloudwatch Logs
logs特定のフレーズ、値、またはパターンを⾒つけるためにログをリアルタイムでモニタリングする
### Cloudwatch Events
- ユースケース
EC2 インスタンスのリタイアメント通知に応じて、自動でEC2インスタンスを停止する
EC2インスタンスのリタイア
→AWS Healthがキャッチ
→CloudWatch Eventsを起動し、通知
→通知をトリガーとして、LambdaでEC2インスタンスを停止する関数を実行
→EC2インスタンス停止
### AWS Health
AWSのリソース、サービス、およびアカウントの状態をリアルタイムで可視化します。
### サービスヘルスダッシュボード
各AWSのサービスの全体的なステータスを確認するには適していますが、EC2インスタンスのリタイアメント通知を自動設定するといった構成には利用されません

## Cloudtrail
**ユーザの証跡**ログをとる。
  - ユースケース
  - Cloudwatch logs、CloudWatch eventsとの連携
  - API呼び出しの関する調査・記録の問題はcloudtrailが関連する可能性大。

## Config
**AWSリソースの構成情報、変更履歴**を記録。
例：未承認の AMI から起動された EC2インスタンスを検知する
ConfigにSNSを連携すれば、SNSを利用した通知設定が可能。（たとえば、リソースが更新されるとメール通知が実施されて、変更内容が表示できる。）
### Confif Rules
ルールに沿った構成変更が行われているかを評価。
- マネージドルール
AWSで定義・提供している汎用性の高いベーシックルール。
- カスタムルール
Lambdaをベースとして自分で作成するルール。
#### トリガータイプ
ルール評価実行のタイミング
- 設定変更時
- 定期的


# 分野 2: 高可用性 8%

## Route53
DNS（＝ドメイン名とIPアドレスを変換（名前解決）するシステム）。
[参考サイト](https://zenn.dev/naoki_mochizuki/articles/d0d9fd2459250baeb37d)
### レコード情報
- Aレコード（ホスト名とIPアドレスの関連づけを定義）
- AAAAレコード（IPv6 のAレコード）
- CNAMEレコード（正規ホスト名に対する別名を定義）
- MXレコード（メールサーバーのホスト名を定義）
- NSレコード（ネームサーバー）
- SOAレコード（管理情報の始点レコード）
- ALIASレコード：AWSサービスのエンドポイントのIPアドレス
### トラフィックルーティング
### ヘルスチェック
応答が返ってくるかをチェックする。タイプが3種類ある。
1. エンドポイントをモニタリングするヘルスチェック
IPアドレスあるいはドメイン名で特定するエンドポイントをモニタリング。
2. 他のヘルスチェック (算出したヘルスチェック) を監視するヘルスチェック
複数のリソースに対して各ヘルスチェックを用意した状況の場合、それら各ヘルスチェックをチェックし、しきい値より下回らないか確認。
3. CloudWatchアラームをモニタリングするヘルスチェック

## CloudFront
CDN。画像や動画をキャッシュ。
- クライアントからオリジンまでのデータの流れ、暗号化処理
### キャッシュヒット率の改善
- クエリ文字列パラメータに基づいてキャッシュするよう、オリジンが一意のオブジェクトを返すクエリ文字列パラメータのみを転送するように設定。
- Cache-Control max-ageディレクティブをオブジェクトに追加し、max-ageに対して最も長い実用的な値を指定。
### 有効期限が切れる前にエッジキャッシュからファイルを削除したい場合
aws cloudfront create-invalidation(無効化)コマンドを使用して、エッジキャッシュのファイルを無効化する。
### レポート
1. キャッシュ統計レポート
　エッジロケーションに関連する統計をグラフ表示。
2. 使用状況レポート
　HTTPおよびHTTPSリクエスト数を確認。
3. ビューワーレポート
　物理デバイス+コンテンツにアクセスするビューワーに関する以下の4つのレポートを表示。
・デバイス : ユーザーが最も頻繁に使用するデバイスのタイプ(デスクトップやモバイルなど)。
・ブラウザ : ChromeやFirefoxなど、ユーザーが最も頻繁に使用するブラウザ。
・OS : Linux、Mac OS X、Windows など、ビューワーが最も頻繁に実行するOS。
・ロケーション : コンテンツに最も頻繁にアクセスするビューワーの場所 (国、州)
4. 人気オブジェクトレポート
5. トップリファラレポート


## Elastic Load Balancing
  - ALB、ELB、NLBで出来る事出来ない事
  - ASG、EC2を含めたデータの流れ、Connection Draining、証明書を使ったデータの暗号化、X-Forwarded-For
### スティッキーセッション
　複数のEC2インスタンスを起動している場合、Cookie を使用してユーザーのリクエストを追跡し、後続のリクエストを同じインスタンスに送信し続ける機能。
　（どのインスタンスにリクエストするかわからないので、スティッキーセッションを設定しないと、ユーザは再ログイン（セッションの頻繁な切断）を頻繁に求められる。）
### アクセスログ
アクセスログの有効化によって、ELBへのリクエストに関する情報を収集できる。
### HTTP応答コードのメトリクス
- HTTPCode_ELB_5XX : ロードバランサーが応答を解析できなかった場合。
- HTTPCode_Backend_4XX : 登録済みインスタンスからクライアントエラー応答が送信された場合。(存在しないリソースにアクセスして404がとなった場合や、Web APIに於いて必須のパラメータが足りなかった場合の400レスポンス等)
- HTTPCode_Backend_5XX : 登録済みインスタンスからサーバーエラー応答が送信された場合。ELB自体に問題が起きた場合、ELB配下に正常(healthy)なインスタンスが1つも無い場合

- EC2 AutoScaling


# 分野 3: デプロイとプロビジョニング 14%
## ElasticBeanstalk
## Opsworks

## Cloudformation(重要)
  - (変更セットやドリフト等、スタック管理の機能やテンプレートの理解(セクション、組み込み関数)
### スタックの更新方法（2通り）
1. 直接更新を実施する
更新をスタックにすぐにデプロイしたい場合。  
テンプレートを送信するか、スタック内のリソースに対して更新を指定する入力パラメータを送信するとCloudFormationによりすぐにデプロイされる。
2. 変更スタックを設定して実行する
変更セットによってスタックを更新する。（スタックを削除して新しいスタックを作成するのではなく）  
変更セットを使用すると、スタックの変更案が実行中のリソースに与える可能性がある影響 (変更によって重要なリソースが削除されたり置き換えられたりしないか等) を確認できる。


### 
UpdatePolicy 属性を使用して、AWS CloudFormation が、AWS::AutoScaling::AutoScalingGroup、AWS::ElastiCache::ReplicationGroup、AWS::Elasticsearch::Domain、または AWS::Lambda::Alias のリソースに対する更新を処理する方法を指定できます。 これにより、新バージョンの更新する際に事前前処理などを指定することで、ダウンタイムを抑える対応を実施することが可能となります。













# 分野 4: ストレージおよびデータの管理 12%
## S3(重要)
- バージョン管理
  - バケットポリシー(JSON記述も理解)、4XX or5XX系のエラーに関するトラブルシューティング、マルチアップロード、S3通知機能、クロスオリジンリソース共有(CORS)
## EBS
## EFS

# 分野 5: セキュリティとコンプライアンス 18%
## IAM ※特に重要
### IAMロール
一時的にアクセスを許可。
  - 権利の委譲
  - **原則：アクセスキーよりIAMロール**

## Certificate Manager(ACM) 
- ACMがサポートされていないリージョンでは、IAM を Certificate Manager として使用する必要がある。
- IAM APIを使用して証明書を取得するには、get-server-certificateコマンドを使用して、証明書のARNを取得。
- 取得した証明書をELBに設定するためには、set-load-balancer-listener-ssl-certificateコマンドを使用して証明書を設定。

## Guard Duty
セキュリティの観点から脅威を検知。
- 機械学習を利用した不正検知が可能です。 
- VPCフローログを解析できます。 
- IPアドレスやドメインリストを解析できます。 

## Artifact
AWSとの契約やコンプライアンスなどに関わる情報を一元管理することができるサービス。監査対応。(CodeArtifact は全く関係ない)
1. レポート機能
ISO認定、PCI(Payment Card Industry)、SOCレポートなどの AWSセキュリティ・コンプライアンスドキュメントをダウンロードできる。
2. 契約に関する機能
AWSとの契約を確認・管理。複数のアカウントに紐づく契約を管理。

## AWS Shield
マネージド型の分散サービス妨害 (DDoS) を防御するAWSサービス。
- スタンダード : 無料。通常、Cloudfrontなどを利用すると自動で適用される。
- アドバンスト : アプリケーションを標的とした攻撃に対する高レベルな保護。
**TODO WAFと何が違う？**

## WAF
ルールを設定してルールがマッチしたアクセスを遮断する機能。
（監視はできない。）

## RDS
- 保管時のRDS DBインスタンスとスナップショットを暗号化するには、**DBインスタンス作成時に**RDS DBインスタンスの暗号化オプションを有効にする。
- インスタンス作成時、**RDS側でSSL証明書が作成され**、DBインスタンスにインストールされる。


# 分野 6: ネットワーク 14%
## VPC(IGW, NAT, VPCエンドポイント)
- IPv6 CIDRブロックのサイズ(/56)は固定。(独自のIPv6アドレス範囲を指定できない)
### VPCピアリング
2つのVPC間をセキュアに通信できる。
（例：異なるアカウントによって所有され、かつ別のリージョンのVPCで稼働されているインスタンス に、パブリックインターネットを通過せずにアクセスできる。）
### ルートのブラックホール状態(現象)
ルートのターゲットが利用できない状態。
ルートテーブルに設定したインターネットゲートウェイやNATゲートウェイを削除すると発生。


- DirectConnect
- VPN

**原則：セキュリティグループは、許可のみ行う。ステートフル**
**原則：ネットワークACLは、明示的な拒否を行う。ステートレス**


# 分野 7: 自動化と最適化 12%
## Lambda

## TrustedAdvisor(重要)
AWS環境を分析し、最適化するためのベストプラクティスを提供。（情報提供のみで、実行は別途必要。）
### コスト最適化
使われていないリソース (= 無駄なコスト) を検出するほか、利用状況を分析して、コスト削減が期待できる割引プランをおすすめ。
- EC2 リザーブドインスタンスの最適化
- アイドル状態の Amazon RDS DB インスタンス
- 使用率の低い Amazon EC2 Instances
- 関連付けられていない Elastic IP Address
### パフォーマンス
パフォーマンス低下に繋がる使い方をしていないかどうかチェックするほか、もっと効率がよい AWS の機能を使う余地がある場合にお知らせ。
- Amazon EC2 から EBS スループット最適化
- EC2 インスタンスセキュリティグループルールの増大
- 使用率の高い Amazon EC2インスタンス
- 利用率が高すぎる Amazon EBS マグネティックボリューム
### セキュリティ
セキュリティリスクのある設定になっていないかどうかチェックするほか、現在よりもセキュリティを高められる推奨の設定があればおすすめ。
- セキュリティグループ - 開かれたポート
- AWS CloudTrail ロギング
- Amazon EBS パブリックスナップショット
- IAM アクセスキーローテーション
- ルートアカウントの MFA
- 公開されたアクセスキー
### フォールトトレランス
過去データから復旧できるようにバックアップを取得しているか、AWS の機能を活用して冗長構成を取れているか、などの点をチェックする。
- Load Balancer の最適化
- Amazon RDS Multi-AZ
- Amazon Route 53 フェイルオーバーリソースレコードセット
- AWS Direct Connect 接続の冗長性
- Amazon EBS スナップショット
### サービス制限
AWS サービス制限の一部 (39 項目) に対して、現在の利用状況と制限値を比較して差分をチェック。
- そもそもサービス制限とは: AWS は各サービスにおいて、ア
カウント毎に利用可能なリソース (EC2 インスタンス台数、
リージョンあたりの VPC 数など) に制限をかけている。

## Inspector
⾃動セキュリティ診断サービス。
対象がEC2インスタンスのみ。（AWSの他のリソースを評価することができない）

## AWSサポート
人的なAWSのサポートサービス。

## コスト管理
  - Cost Exploler、Billing Manager、AWS 使用状況レポート、組織内にアカウント招待、削除の際の流れ
  - EC2 スポットブロック：スポットインスタンスを1~6時間継続して利用できることが担保された入札形式。

## Cost Explorer

## Systems Manager
([参考サイト](https://dev.classmethod.jp/articles/relay-re-introduction-2019-ssm/))
サーバ群を管理する多機能なツールセットの総称。
（範囲が広すぎてどこまでが"AWS Systems Manager"というサービスの中に収めるべきなのかよくわからない）
  - シークレットデータの格納
### 使う前の手順
・SSM Agentの導入
・SSM AgentからSSM APIへの経路確保
・IAMロールの付与
### Patch Manager
OSパッチの管理。セキュリティ関連のアップデートおよびその他のタイプのアップデートの両方に関して、インスタンスへのパッチ適用プロセスを自動化します。オペレーティングシステムとアプリケーションの両方にパッチを適用することができます。
（AWS Batch：バッチコンピューティングワークロード(大規模計算)を実行）
### Systems Manager Automation
自動化ワークフローを構築して、EC2インスタンスおよび他のAWSリソースの一般的なメンテナンスとデプロイに関する運用タスクを自動化することが可能。

## StepFunctions
### ステートマシン
？
### ワークフロー
可視化のツール。


# その他
## Amazon Athena
標準SQLを使用してS3バケットにホストされているデータを分析し、レポートを作成できる。
## Amazon CloudSearch
AWSで完全に管理された検索サービス。高速で非常に拡張性の高い検索機能をアプリケーションに容易に統合できる。
## Amazon Redshift
データウェアハウス・BI（ビジネスインテリジェンス）のサービス。