---
title: "現場で役立つシステム設計の原則"
emoji: "🕌"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["設計"]
published: false
---

# 1. 小さくまとめてわかりやすくする
## 設計とは
どこに何が書いているのかわかりやすくすること。
（そうすることで、変更や拡張が楽で安全になるコードを生み出すように導く。）

## プログラムの変更が楽になる方法
- わかりやすい名前を使う。（**名前重要**）
- 意味のかたまりごとに改行する。
- 目的ごとに変更を用意する。（**説明用変数**の導入）
  - 1つの変数に使いまわさない。（= 破壊的代入をしない。）
  - 変更の影響範囲を小さくできる。
- メソッドに切り出す。（**メソッドの抽出**）
- **異なるクラスの重複したコードを無くす**。
- **狭い関心事に特化したクラスにする**。
- **メソッドは短く**。**クラスは小さく**。

## 基本データ型の落とし穴
- 基本データ型では扱える範囲が広すぎて、アプリケーションにとって適切でない場合がある。
  （例：intは、マイナス21億〜21億までの整数）
  **値を扱うためのクラス**（**値オブジェクト**）を定義して、範囲外の値は異常値としてエラーにする等、適切な範囲の値を取り扱う。
:::message
業界の用語をそのままクラス名やメソッド名に使うと、プログラムが業務の説明書になる。
:::

## 値オブジェクトは不変にする
- インスタンス変数はコンストラクタで（インスタンス生成時に）設定。
- インスタンス変数を変更するメソッド（setter）を作らない。
- 別の値が必要になったら、別のオブジェクトを作成する。

## 複雑さを閉じ込める
- コレクション型のデータとロジックを特別扱いにして、**コレクションを1つだけ持つ専用クラス**（**コレクションオブジェクト**）を作る。
  - 値オブジェクトと同じように、コレクションオブジェクトも不変にする。
:::message
**コレクションオブジェクトは**、たいていの場合**業務の関心事**そのもの。
:::

# 2. 場合分けのロジックを整理する
## プログラムを複雑にする 場合分けのコード
- else句をなくすと条件分岐が単純になる。
  - else句を使わず早期リターンする。（ガード節）
- 複文は単文に分ける。
  - else句を使わずに独立性の高い単文を書く。
- 区分ごとのロジックを別クラスに分ける。
  - インターフェースを用いてポリモーフィズム（多態性 = 別のクラスを同じ型として扱う）を実現する。
  - クラス間は、互いを知らないほど良い。結合が弱くなり（独立性が高くなり）、変更による別クラスへの影響が減る。

