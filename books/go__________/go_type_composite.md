---
title: "Go_複合型（コンポジット型）"
---

複数の要素を持つ型。配列、スライス、マップが該当。

# 配列 : `[n]T`

特定の同じ型の、**固定長**のデータ構造。
**宣言または初期化するときにサイズ（要素数）の定義が必要**。また、**作成後にサイズを変更することができない**。
これにより、配列は Go プログラムでは一般に使用されないが、スライスとマップの基盤となっている。

## 初期化方法

#### 空の箱だけ作る（値は指定しない）場合

```go
var arr [3]int // [0 0 0]
```

↓ でもできるんだが、スライスのときは基本的には ↑ の書き方をしたほうが良いので、配列も ↑ で覚えておく。

```go:使わない
arr := [3]int{}
```

#### 値をセットして初期化する場合

```go
arr := [3]int{10, 20} // [10 20 0]
```

#### 要素数がわからない場合

```go
arr := [...]int{ ???? }
```

#### 指定の位置だけ、値をセットする方法

```go
arr := [...]int{1: 30, 4: 20} // [0 30 0 0 20]
```

## 操作

- アクセス : `arr[i]`
- 長さ : `len(arr)`
- スライス演算 : `arr[2:5]`
  配列からスライスを作る。この例だと`arr[2] から arr[5-1] まで`を抽出したものになる。（`arr[5]`まで ではないので注意!）
  ```go:スライス演算
  arr := [...]string{"a", "b", "c", "d", "e", "f"}
  fmt.Println(arr[2:5]) // [c d e]
  ```

## 2 次元配列

```go:2次元配列
var twoD [3][5]int

for i := 0; i < 3; i++ {
  for j := 0; j < 5; j++ {
    twoD[i][j] = (i + 1) * (j + 1)
  }
  fmt.Println("Row", i, ":", twoD[i])
}
fmt.Println(twoD)
/*
  Row 0 : [1 2 3 4 5]
  Row 1 : [2 4 6 8 10]
  Row 2 : [3 6 9 12 15]
  [[1 2 3 4 5] [2 4 6 8 10] [3 6 9 12 15]]
/*
```

# スライス : `[]T`

**配列の一部を切り出した**データ型。（スライスは配列を切り出したものなので、**背後には必ず配列が存在する**。）
:::message
スライスを使うときは、参照している（背後の）配列を意識すること。
:::

配列との大きな違いは、スライスの**長さ**（サイズ）が固定ではなく**動的**であること。

スライスは下記 3 つの要素を持っている。（この 3 要素の構造体である。）

1. **ポインタ** : 基となる配列の**最初の要素の場所**（**切り出した場所**）を表す。
1. **len** : 切り出した長さ。スライス内の要素数。
1. **cap**（容量） : 基になる配列に対して、ポインタの位置（切り出した位置）から配列の終端までの要素数。つまり、このスライスはどこまで拡張できるのかを表す量。

## 初期化方法

#### 空のスライスを作る場合

```go
s := []string{} // 長さ0のスライス
```

よりも

```go
var s []string // nilのスライス
```

を使う。
前者は長さ 0 のスライスを生成するが、後者は nil のスライスとなるため。
（JSON オブジェクトをエンコードする際など、限られた状況で nil ではなく長さ 0 のスライスのほうが好まれる状況がある。 nil スライスは null に変換されますが、[]string{} は [] に変換される。）

#### （既にある）配列から切り出す場合

```go:スライス演算子
arr[2:5]
```

**スライス演算子**`s[i:p]`によって、この例だと`arr[2] から arr[5-1] まで`を抽出したものになる。
i と p は省略することもでき、配列の全要素をベースにする場合は`arr[:]`となる。

#### 基になる配列は指定せずにスライスだけを作る場合

```go:スライスリテラル
[]int{1, 2, 3}
```

（内部的に`{1, 2, 3}`の配列が自動で作られ、それをスライスが参照している。）

指定の位置に値を指定するには、

```go
[]int{2: 10, 5: 20} // [0 0 10 0 0 20]
```

#### 指定した要素数、容量のスライスを作る場合

```go:makeメソッド
make([]int, 3, 10) // make([]型名, length, capacity)
```
```
